(function($){'use strict';jQuery(document).ready(function($){$(window).load(function(){var key;var nextSelector=selector.nextSelector;var navigationSelector=selector.navigationSelector;var contentSelector=selector.contentSelector;var itemSelector=selector.contentSelector+' '+selector.itemSelector;var destUrl=$(nextSelector).attr('href');var finished=false;var flag=false;var current_url;var uniqueRandoms=[];if($(nextSelector).length&&$(navigationSelector).length&&$(itemSelector).length&&$(contentSelector).length){$(navigationSelector).css('display','none');$('body').addClass('infinite-scroll');var trigger=selector.event;$(itemSelector).last().after('<span class="infinite-loader"><div id="ctis-loading" class="spinner"><img src="'+selector.image+'"></div></span>');if('click'==trigger){$(itemSelector).last().after('<div id="infinite-handle" class="ctis-load-more-container"><span class="ctis-load-more"><button>'+selector.load_more_text+'</button></span></div>');load_on_click();}else{load_on_scroll();}
    $(window).scroll(function(){var t=$(this),elem=$(itemSelector).last();if(typeof elem=='undefined'){return;}
        if(finished&&(t.scrollTop()+t.height())>=(elem.offset().top+elem.height())){setTimeout(function(){$('.ctis-finished-notice').fadeOut('slow');},3000);}});}
    function ctis_load_more(){$.ajax({url:destUrl,beforeSend:show_loader(),success:function(results){var img;var code;var ads;var ads_array;var ads_count;var temp;var count=0;ads_array=$.map(selector.load_more_adv,function(v){return v===""?null:v;});ads_count=parseInt(ads_array.length);key=makeUniqueRandom(ads_count);ads=get_ads(selector,key);if(''!=ads){ads='<div class="ctis-ad-container hentry grid-item">'+ads+'</div>';}
        $(itemSelector).last().after(ads);if(selector.jetpack_enabled){$('.infinite-loader').css('text-indent','0');$('.infinite-loader').css('height','auto');}
        hide_loader();var obj=$(results);var elem=obj.find(itemSelector);var next=obj.find(nextSelector);var current_url=destUrl;if(next.length!==0){$(nextSelector).attr('href',next.attr('href'));}
        elem.each(function(){if($('.ctis-ad-container').length&&''!=ads&&0==count){$('.ctis-ad-container').last().after($(this));}else{$(itemSelector).last().after($(this));}
            count++;});$(itemSelector).trigger('post-load');if(next.length!==0&&next.attr('href')!='#'){destUrl=$(nextSelector).attr('href');}else{finished=true;$('body').addClass('infinity-end');$('.ctis-load-more-container').hide();$(itemSelector).last().after('<div class="ctis-finished-notice infinite-loader"><span class="finish-text spinner">'+selector.finish_text+'</span></div>');}},error:function(results){hide_loader();}});}
    function makeUniqueRandom(count){if(!uniqueRandoms.length){for(var i=0;i<count;i++){uniqueRandoms.push(i);}}
        var index=Math.floor(Math.random()*uniqueRandoms.length);var val=uniqueRandoms[index];uniqueRandoms.splice(index,1);return val;}
    function show_loader(){flag=true;$('#ctis-loading').show();$('.infinite-loader').show();$('.ctis-load-more-container').hide();}
    function hide_loader(){$('#ctis-loading').hide();$('.infinite-loader').hide();$('.ctis-load-more-container').show();setTimeout(function(){flag=false;},500);}
    function load_on_scroll(){$(window).on('scroll',function(){var t=$(this),elem=$(itemSelector).last();if(typeof elem=='undefined'){return;}
        if(flag===false&&!finished&&(t.scrollTop()+t.height())>=(elem.offset().top+elem.height())){ctis_load_more();}});}
    function load_on_click(){$('body').on('click','.ctis-load-more',function(){ctis_load_more();});}
    function get_ads(selector,i){var ads='';var ads_link=selector.load_more_adv_image_link[i];var ads_alt='';var ads_target='';if('1'==selector.load_more_adv_image_target[i]){ads_target='target="_blank"';}
        if(''!=selector.load_more_adv_image_alt[i]){ads_alt='alt="'+selector.load_more_adv_image_alt[i]+'"';}
        if('image'==selector.load_more_adv[i]){var img=selector.load_more_adv_image[i];ads='<img src="'+img+'"'+ads_alt+'>';if(''!=ads_link){ads='<a href="'+ads_link+'"'+ads_target+'>'+ads+'</a>';}}else if('code'==selector.load_more_adv[i]){ads=selector.load_more_adv_code[i];}
        return ads;}});});})(jQuery);